<html>
	<head>
		<title>Game:Play Application Launcher</title>
		<script src="js/init.js"></script>
		<link rel="stylesheet" type="text/css" href="css/main.css">
	</head>
	<body class="loading" data-bind="
		attr: {
			'data-select-scope': currentApp() ? '#current-app-dialog .selectable' : undefined
		},
		css: {
			'loading': false
		}
	">
		<div id="loader"></div>
		<header>
			<div class="logo"><img src="img/GamePlay.svg" title="Game:Play Application Launcher"></div>
			<div class="locale">
				<select size="1" data-bind="value: locale, options: locale.available, optionsValue: 'id', optionsText: 'label'"></select>
			</div>

			<!-- ko foreach: currentGamepads -->
				<div class="gamepad" data-bind="attr: { title: (index + 1) + ' ' + id, 'data-index': index + 1 }">
					<img src="img/gamepads/Gamepad.svg">
				</div>
			<!-- /ko -->

			<div class="clock">
				<span data-bind="text: currentTimeStr"></span>
			</div>
		</header>


		<div id="widgets" style="display: none" data-bind="style: { display: undefined }">
			<div id="widget-filter" class="hidden" data-bind="css: { 'hidden': !filter() }">
				<input type="text" data-bind="textInput: filter">
				<button data-bind="t: 'clear', click: function() { filter(''); }, css: { 'selectable': filter }">Clear</button>
			</div>

			<ul class="widget-app-list" data-bind="foreach: filteredApps.extend({ delay: { timeout: 30, items: 25 } })">
				<li class="widget selectable" data-bind="
					attr: {
						'data-app': id
					},
					css: {
						'current-app': $data == $root.currentApp(),
						'running-app': $root.gameplay.statusById($data).active
					},
					click: $root.currentApp
				">
					<!-- ko if: $data['icon'] -->
						<div class="icon" data-bind="
							style: {
								'background-image': 'url(\'' + $data['icon'] + '\')'
							}
						"></div>
					<!-- /ko -->
					<!-- ko if: $data['icon:selected'] -->
						<div class="icon-selected" data-bind="
							style: {
								'background-image': 'url(' + $data['icon:selected'] + ')'
							}
						"></div>
					<!-- /ko -->
					<div class="label" data-bind="text: label"></div>
				</li>
			</ul>
			<!-- ko if: gameplay.apps().length == 0 -->
				<div class="no-apps-found" data-bind="t: 'no-apps-found'">
					No applications found. See README.md to learn how to configure application providers.
				</div>
			<!-- /ko -->
		</div>
		<div id="copyright-notice">
			<!-- Text filled by theme.css -->
			<div class="copyright-notice-background"></div>
			<div class="copyright-notice-icons"></div>
			<div class="copyright-notice-other"></div>
		</div>

		<!-- ko if: currentApp -->
			<div id="current-app-dialog" class="dialog" style="display: none" data-bind="style: { display: undefined }">
				<!-- ko with: { app: currentApp(), status: gameplay.statusById(currentApp()) } -->
					<div class="dialog-label" data-bind="text: app.label"></div>
					<div class="dialog-content" data-bind="
						style: {
							'background-image': app['icon'] ? 'url(\'' + app['icon'] + '\')' : undefined
						}
					">
					</div>
					<div class="dialog-buttons">
						<!-- ko if: status.active -->
							<button class="selectable button-stop" data-bind="click: function() { $root.gameplay.stopApp(app); }">Stop</button>
							<!-- ko if: status.suspended -->
								<button class="selectable button-resume" data-bind="click: function() { $root.gameplay.resumeApp(app); }">Resume</button>
							<!-- /ko -->
							<!-- ko ifnot: status.suspended -->
								<button class="selectable button-suspend" data-bind="click: function() { $root.gameplay.suspendApp(app); }">Suspend</button>
							<!-- /ko -->
						<!-- /ko -->
						<!-- ko ifnot: status.active -->
							<button class="selectable button-run" data-bind="click: function() { $root.gameplay.runApp(app); }">Run</button>
						<!-- /ko -->
						<button class="selectable button-close" data-bind="click: function() { $root.currentApp(undefined); }">Close</button>
					</div>
				<!-- /ko -->
			</div>
		<!-- /ko -->

	</body>
</html>
